<!DOCTYPE html>

<head>
    <style>
        p{
            font-size: larger;
        }
        td {
            border: solid 1px;
            width: 40px;
            text-align: center;
            font-size: larger;
        }

        tr {
            height: 40px;
        }

        .gr {
            background-color: #BBBBBB;
        }

        .column {
            float: left;
            width: 50%;
            padding: 10px;
        }

        .row:after {
            content: "";
            display: table;
            clear: both;
        }
    </style>
</head>

<body style="margin:1 rem">
    <h2>=== The Knight's Tour ===</h2>
    <div class="row">
        <div style="width: 50%;" class="column">
            <table>
                <tr>
                    <td id="C18"></td>
                    <td id="C28" class="gr"></td>
                    <td id="C38"></td>
                    <td id="C48" class="gr"></td>
                    <td id="C58"></td>
                    <td id="C68" class="gr"></td>
                    <td id="C78"></td>
                    <td id="C88" class="gr"></td>
                </tr>
                <tr>
                    <td id="C17" class="gr"></td>
                    <td id="C27"></td>
                    <td id="C37" class="gr"></td>
                    <td id="C47"></td>
                    <td id="C57" class="gr"></td>
                    <td id="C67"></td>
                    <td id="C77" class="gr"></td>
                    <td id="C87"></td>
                </tr>
                <tr>
                    <td id="C16"></td>
                    <td id="C26" class="gr"></td>
                    <td id="C36"></td>
                    <td id="C46" class="gr"></td>
                    <td id="C56"></td>
                    <td id="C66" class="gr"></td>
                    <td id="C76"></td>
                    <td id="C86" class="gr"></td>
                </tr>
                <tr>
                    <td id="C15" class="gr"></td>
                    <td id="C25"></td>
                    <td id="C35" class="gr"></td>
                    <td id="C45"></td>
                    <td id="C55" class="gr"></td>
                    <td id="C65"></td>
                    <td id="C75" class="gr"></td>
                    <td id="C85"></td>
                </tr>
                <tr>
                    <td id="C14"></td>
                    <td id="C24" class="gr"></td>
                    <td id="C34"></td>
                    <td id="C44" class="gr"></td>
                    <td id="C54"></td>
                    <td id="C64" class="gr"></td>
                    <td id="C74"></td>
                    <td id="C84" class="gr"></td>
                </tr>
                <tr>
                    <td id="C13" class="gr"></td>
                    <td id="C23"></td>
                    <td id="C33" class="gr"></td>
                    <td id="C43"></td>
                    <td id="C53" class="gr"></td>
                    <td id="C63"></td>
                    <td id="C73" class="gr"></td>
                    <td id="C83"></td>
                </tr>
                <tr>
                    <td id="C12"></td>
                    <td id="C22" class="gr"></td>
                    <td id="C32"></td>
                    <td id="C42" class="gr"></td>
                    <td id="C52"></td>
                    <td id="C62" class="gr"></td>
                    <td id="C72"></td>
                    <td id="C82" class="gr"></td>
                </tr>
                <tr>
                    <td id="C11" class="gr"></td>
                    <td id="C21"></td>
                    <td id="C31" class="gr"></td>
                    <td id="C41"></td>
                    <td id="C51" class="gr"></td>
                    <td id="C61"></td>
                    <td id="C71" class="gr"></td>
                    <td id="C81"></td>
                </tr>
            </table>
            <button id="btn" onclick="next()">&#x23E9;</button>
            <button id="aut" onclick="auto()">Auto</button>
            <button id="rst" onclick="reset()">Reset</button>
        </div>
        <div style="width: 50%; position: relative; float: right;" class="column">
            <p>A <b>knight's tour</b> is a sequence of moves of a knight on a chessboard such that the knight visits
                every square exactly once.</p>
        </div>
    </div>
    <script>
        reset();

        function assign(inputArray) {
            for (j = 0; j <= 7; j++)
                for (i = 0; i <= 7; i++) {
                    indexValue = indexes[i][j];
                    if (indexValue == 0) indexValue = "";
                    cellName = "C" + (i + 1) + "" + (j + 1);
                    document.getElementById(cellName).innerHTML = indexValue;
                }
            cellName = "C" + currentX + "" + currentY;
            document.getElementById(cellName).innerHTML = "<strong>&#9822;</strong>";
        }

        function next() {
            document.getElementById("aut").setAttribute("disabled", "disabled");
            pt = potentialMoves();
            if (pt.length == 0) {
                gameover();
            } else {
                ch = chooseOne(pt);
                indexes[ch[0] - 1][ch[1] - 1] = ++currentTurn;
            }
            assign(indexes);
        }
        function auto() {
            document.getElementById("btn").setAttribute("disabled", "disabled");
            myInt = setInterval(next, 400);
        }

        function reset() {
            document.getElementById("btn").removeAttribute("disabled");
            document.getElementById("aut").removeAttribute("disabled");
            for (i = 1; i <= 8; i++)
                for (j = 1; j <= 8; j++) {
                    tdId = "C" + i + "" + j;
                    document.getElementById(tdId).setAttribute("onclick", "manual(" + i + ", " + j + ")");
                }

            indexes = [
                [0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 0, 0, 0, 0, 0, 1],
                [0, 0, 0, 0, 0, 0, 0, 0]
            ];
            myInt = 0;
            currentTurn = 1;
            currentX = 7;
            currentY = 8;

            assign(indexes);
        }

        function potentialMoves() {
            const potentials = [[0, 0]];
            test = potentials;
            tempNewX = currentX + 2;
            tempNewY = currentY + 1;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX + 2;
            tempNewY = currentY - 1;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX + 1;
            tempNewY = currentY + 2;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX + 1;
            tempNewY = currentY - 2;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX - 1;
            tempNewY = currentY + 2;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX - 1;
            tempNewY = currentY - 2;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX - 2;
            tempNewY = currentY + 1;
            addElement(tempNewX, tempNewY);
            tempNewX = currentX - 2;
            tempNewY = currentY - 1;
            addElement(tempNewX, tempNewY);
            potentials.shift();
            return potentials;

            function addElement(x, y) {
                if (x > 0 && x <= 8 && y > 0 && y <= 8)
                    if (indexes[x - 1][y - 1] == 0) potentials.push([x, y]);
            }
        }

        // Chooses one pairs of potential options
        function chooseOne(inputPot) {
            rnd = Math.round(Math.random() * (inputPot.length - 1));
            ret = inputPot[rnd];
            currentX = ret[0];
            currentY = ret[1];
            return ret;
        }

        function manual(tdX, tdY) {
            document.getElementById("aut").setAttribute("disabled", "disabled");
            pt = potentialMoves();
            if (pt.length == 0) {
                gameover();
            } else {
                for (j = 0; j < pt.length; j++) {
                    if (pt[j][0] == tdX && pt[j][1] == tdY) {
                        indexes[tdX - 1][tdY - 1] = ++currentTurn;
                        currentX = tdX;
                        currentY = tdY;
                    }
                }
            }
            assign(indexes);
        }

        function gameover() {
            w = document.getElementsByTagName('td');
            for (i = 0; i < w.length; i++) {
                w[i].removeAttribute("onclick");
            }
            document.getElementById("btn").setAttribute("disabled", "disabled");
            if (myInt > 0) clearInterval(myInt);
            console.log("Last turn was ", currentTurn);
        }
    </script>
</body>
